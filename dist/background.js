!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";t.r(n);var o,r={general:{extensionName:"sfx",extensionId:"555",chromeExtensionProtocol:"chrome-extension:"},libraries:{PubSub:{portMessageType:"PubSub",urlPattern:"https://*/*"}},services:{},models:{UserOptions:{storageKey:"UserOptions",defaults:{isUrlRewriterOn:!0}}},background:{},content:{},popup:{},options:{}},s=function(){function e(){}return e.init=function(){return chrome.runtime.onMessage.addListener(function(n){n.extensionName===r.general.extensionName&&n.extensionId===r.general.extensionId&&n.messageType===r.libraries.PubSub.portMessageType&&e.emitLocal(n.eventName,n.data)}),e.getIsContentPage()},e.getIsContentPage=function(){return location.protocol!==r.general.chromeExtensionProtocol},e.subscribe=function(n,t){e.callbacksByEvents[n]=e.callbacksByEvents[n]||[],e.callbacksByEvents[n].push(t)},e.unsubscribe=function(n,t){var o=e.callbacksByEvents[n];if(o)for(var r=0;r<o.length;r++)if(o[r]===t){o.splice(r,1);break}},e.emit=function(n,t){void 0===t&&(t={}),e.emitGlobal(n,t),e.emitLocal(n,t)},e.emitLocal=function(n,t){var o=e.callbacksByEvents[n];o&&o.forEach(function(e){e(t)})},e.emitGlobal=function(n,t){e.isContentPage||e.sendMessageToContent(n,t),e.sendMessageToExtension(n,t)},e.sendMessageToExtension=function(e,n){var t=new i(e,n);chrome.runtime.sendMessage(t)},e.sendMessageToContent=function(e,n){var t=new i(e,n);chrome.tabs.query({url:r.libraries.PubSub.urlPattern},function(e){for(var n=0;n<e.length;++n)chrome.tabs.sendMessage(e[n].id,t)})},e.callbacksByEvents={},e.isContentPage=e.init(),e}(),i=function(e,n){this.extensionName=r.general.extensionName,this.extensionId=r.general.extensionId,this.messageType=r.libraries.PubSub.portMessageType,this.eventName=e,this.data=n};!function(e){e.onUserOptionsUpdate="userOptionsUpdate",e.onInitRequest="initDataRequest",e.onInit="initData"}(o||(o={}));var a=function(){function e(){}return e.updateFromStorage=function(n,t){chrome.storage.local.get(n.__key__,function(o){var r=o[n.__key__],s=Object.assign({},n);if(void 0!==r)for(var i in s)void 0!==r[i]&&(s[i]=r[i]);e.updateToStorage(s),t(s)})},e.updateToStorage=function(e){chrome.storage.local.set(e)},e}(),u=r.models.UserOptions.storageKey,c=r.models.UserOptions.defaults,l=function(e){void 0===e&&(e=c.isUrlRewriterOn),this.__key__=u,this.isUrlRewriterOn=e},f=new function(){this.userOptions=new l};a.updateFromStorage(f.userOptions,function(e){f.userOptions=e,s.emit(o.onUserOptionsUpdate,e),console.log("updated from storage"),console.log(f.userOptions)}),s.subscribe(o.onUserOptionsUpdate,function(e){f.userOptions=e,a.updateToStorage(e)}),s.subscribe(o.onInitRequest,function(){s.emit(o.onInit,f.userOptions),console.log("got an init request")})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbmZpZy9hcHAuY29uZmlnLnRzIiwid2VicGFjazovLy8uL3NyYy9jb25maWcvRXZlbnROYW1lcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbGlicmFyaWVzL1B1YlN1Yi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvc2VydmljZXMvU3RvcmFnZVNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZGVscy9Vc2VyT3B0aW9ucy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYmFja2dyb3VuZC9iYWNrZ3JvdW5kLnRzIiwid2VicGFjazovLy8uL3NyYy9tb2RlbHMvQmFja2dyb3VuZC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkV2ZW50TmFtZXMiLCJhcHBDb25maWciLCJnZW5lcmFsIiwiZXh0ZW5zaW9uTmFtZSIsImV4dGVuc2lvbklkIiwiY2hyb21lRXh0ZW5zaW9uUHJvdG9jb2wiLCJsaWJyYXJpZXMiLCJQdWJTdWIiLCJwb3J0TWVzc2FnZVR5cGUiLCJ1cmxQYXR0ZXJuIiwic2VydmljZXMiLCJtb2RlbHMiLCJVc2VyT3B0aW9ucyIsInN0b3JhZ2VLZXkiLCJkZWZhdWx0cyIsImlzVXJsUmV3cml0ZXJPbiIsImJhY2tncm91bmQiLCJjb250ZW50IiwicG9wdXAiLCJvcHRpb25zIiwiaW5pdCIsImNocm9tZSIsInJ1bnRpbWUiLCJvbk1lc3NhZ2UiLCJhZGRMaXN0ZW5lciIsIm1lc3NhZ2UiLCJtZXNzYWdlVHlwZSIsImVtaXRMb2NhbCIsImV2ZW50TmFtZSIsImRhdGEiLCJnZXRJc0NvbnRlbnRQYWdlIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInN1YnNjcmliZSIsImNhbGxiYWNrIiwiY2FsbGJhY2tzQnlFdmVudHMiLCJwdXNoIiwidW5zdWJzY3JpYmUiLCJldmVudENhbGxiYWNrcyIsImxlbmd0aCIsInNwbGljZSIsImVtaXQiLCJlbWl0R2xvYmFsIiwiZm9yRWFjaCIsImlzQ29udGVudFBhZ2UiLCJzZW5kTWVzc2FnZVRvQ29udGVudCIsInNlbmRNZXNzYWdlVG9FeHRlbnNpb24iLCJzZW5kTWVzc2FnZSIsInRhYnMiLCJxdWVyeSIsInVybCIsImlkIiwidGhpcyIsInVwZGF0ZUZyb21TdG9yYWdlIiwibW9kZWwiLCJzdG9yYWdlIiwibG9jYWwiLCJfX2tleV9fIiwicmVzdWx0Iiwic3RvcmVkTW9kZWwiLCJ1cGRhdGVkTW9kZWwiLCJhc3NpZ24iLCJ1bmRlZmluZWQiLCJTdG9yYWdlU2VydmljZSIsInVwZGF0ZVRvU3RvcmFnZSIsInNldCIsInN0YXRlIiwidXNlck9wdGlvbnMiLCJvblVzZXJPcHRpb25zVXBkYXRlIiwiY29uc29sZSIsImxvZyIsIm9uSW5pdFJlcXVlc3QiLCJvbkluaXQiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxF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cm91bmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCIvKlxyXG4gIFRoaW5rIG9mIHRoaXMgZmlsZSBhcyBha2luIHRvIHRoZSB3ZWIuY29uZmlnIGZpbGVcclxuICB1c2VkIGJ5IElJUyB3ZWIgYXBwbGljYXRpb25zLiBXZSBzaG91bGQgc3RvcmUgYXBwbGljYXRpb25cclxuICBjb25maWd1cmF0aW9uIHNldHRpbmdzIGhlcmUsIGFuZCB0aGVuIHJlZmVyZW5jZSB0aGlzXHJcbiAgb2JqZWN0IGZyb20gb3VyIHNjcmlwdHMuIElmIGFueSBjaGFuZ2VzIG5lZWQgdG8gYmUgbWFkZVxyXG4gIHRvIHRoZXNlIHNldHRpbmdzIGluIHRoZSBmdXR1cmUsIHdlIHNob3VsZCBvbmx5IG5lZWQgdG8gY2hhbmdlXHJcbiAgaXQgaGVyZS5cclxuKi9cclxuXHJcbmV4cG9ydCBjb25zdCBhcHBDb25maWcgPSB7XHJcbiAgZ2VuZXJhbDoge1xyXG4gICAgZXh0ZW5zaW9uTmFtZTogJ3NmeCcsXHJcbiAgICBleHRlbnNpb25JZDogJzU1NScsXHJcbiAgICBjaHJvbWVFeHRlbnNpb25Qcm90b2NvbDogJ2Nocm9tZS1leHRlbnNpb246J1xyXG4gIH0sXHJcbiAgbGlicmFyaWVzOiB7XHJcbiAgICBQdWJTdWI6IHtcclxuICAgICAgcG9ydE1lc3NhZ2VUeXBlOiAnUHViU3ViJyxcclxuICAgICAgdXJsUGF0dGVybjogJ2h0dHBzOi8vKi8qJ1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgc2VydmljZXM6IHt9LFxyXG4gIG1vZGVsczoge1xyXG4gICAgVXNlck9wdGlvbnM6IHtcclxuICAgICAgc3RvcmFnZUtleTogJ1VzZXJPcHRpb25zJyxcclxuICAgICAgZGVmYXVsdHM6IHtcclxuICAgICAgICBpc1VybFJld3JpdGVyT246IHRydWVcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgYmFja2dyb3VuZDoge30sXHJcbiAgY29udGVudDoge30sXHJcbiAgcG9wdXA6IHt9LFxyXG4gIG9wdGlvbnM6IHt9XHJcbn07XHJcbiIsIi8qXHJcbiAgQW55IGV2ZW50cyBzZW50IHRocm91Z2ggdGhlIFB1YlN1YiBjbGFzcyBzaG91bGQgdXNlXHJcbiAgdXNlIHRoZSBFdmVudE5hbWVzIGVudW0gaW5zdGVhZCBvZiBtYW51YWxseSB0eXBpbmdcclxuICBpbiB0aGUgZXZlbnQgbmFtZSBzdHJpbmcuXHJcblxyXG4gIFRoaXMgc2hvdWxkIGtlZXAgdXMgZnJvbSBjcmVhdGluZyB0eXBvcyBhbmQgaG9wZWZ1bGx5LFxyXG4gIG1ha2UgaXQgZWFzaWVyIHRvIG1haW50YWluLlxyXG5cclxuICBXZSBzaG91bGQgYWxzbyB0cnkgdG8ga2VlcCB0aGUgZXZlbnQgZGF0YSBzZW50IHdpdGggUHViU3ViXHJcbiAgY29uc2lzdGVudCBwZXIgZXZlbnQuXHJcbiovXHJcblxyXG5leHBvcnQgZW51bSBFdmVudE5hbWVzIHtcclxuICBvblVzZXJPcHRpb25zVXBkYXRlID0gJ3VzZXJPcHRpb25zVXBkYXRlJyxcclxuICBvbkluaXRSZXF1ZXN0ID0gJ2luaXREYXRhUmVxdWVzdCcsXHJcbiAgb25Jbml0ID0gJ2luaXREYXRhJ1xyXG59XHJcbiIsIi8qXHJcblRoaXMgcHN1ZWRvLXN0YXRpYyBjbGFzcyBleHBvc2VzIHRoZSBmb2xsb3dpbmcgbWV0aG9kczpcclxuICBcclxuICAtLSAgc3Vic2NyaWJlKGV2ZW50TmFtZTogc3RyaW5nLCBjYWxsYmFjazogY2FsbGJhY2spOiB2b2lkXHJcblxyXG4gICAgICAgIEFsbG93cyB0aGUgdXNlciB0byBzdWJjc3JpYmUgdG8gZXZlbnRzIHRoYXRcclxuICAgICAgICBhcmUgZW1pdHRlZCBsb2NhbGx5IGZyb20gdGhlIGNhbGxpbmcgc2NyaXB0LCBvclxyXG4gICAgICAgIGVtaXR0ZWQgZnJvbSBhIGJhY2tncm91bmQsIGNvbnRlbnQsIHBvcHVwLCBvciBvcHRpb25zXHJcbiAgICAgICAgcGFnZSBzY3JpcHQuXHJcblxyXG4gIC0tICB1bnN1YnNjcmliZShldmVudE5hbWU6IHN0cmluZywgY2FsbGJhY2s6IGNhbGxiYWNrKTogdm9pZFxyXG5cclxuICAgICAgICBBbGxvd3MgdGhlIHVzZXIgdG8gdW5zdWJjcmliZSBmcm9tIGFuIGV2ZW50IHRoZXkgd2VyZVxyXG4gICAgICAgIHByZXZpb3VzbHkgc3Vic2NyaWJlIHRvLCBieSBwcm92aWRpbmcgdGhlIGV2ZW50IG5hbWUgYW5kIFxyXG4gICAgICAgIGEgcmVmZXJlbmNlIHRvIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBvcmlnaW5hbGx5IHVzZWQgdG9cclxuICAgICAgICBzdWJzY3JpYmUgdG8gdGhlIGV2ZW50LlxyXG5cclxuICAtLSAgZW1pdChldmVudE5hbWU6IHN0cmluZywgZGF0YTogYW55KTogdm9pZFxyXG5cclxuICAgICAgICBBbGxvd3MgdGhlIHVzZXIgdG8gZW1pdCBldmVudC4gVGhlIGV2ZW50IHdpbGwgYmUgc2VudFxyXG4gICAgICAgIHRvIGFsbCBzdWJzY3JpYmVycywgYm90aCBsb2NhbGx5IHdpdGhpbiB0aGUgY2FsbGluZ1xyXG4gICAgICAgIHNjcmlwLCBhcyB3ZWxsIGFzIGdsb2JhbGx5LCB0byBhbnkgb3RoZXIgc2NyaXB0cyBzdWJzY3JpYmVkXHJcbiAgICAgICAgdG8gdGhlIGV2ZW50IHRocm91Z2ggdGhpcyBQdWJTdWIgY2xhc3MuXHJcbiovXHJcblxyXG5pbXBvcnQgeyBhcHBDb25maWcgfSBmcm9tICcuLi9jb25maWcvYXBwLmNvbmZpZyc7XHJcblxyXG5leHBvcnQgY2xhc3MgUHViU3ViIHtcclxuICBwcml2YXRlIHN0YXRpYyBjYWxsYmFja3NCeUV2ZW50czogeyBbZXZlbnROYW1lOiBzdHJpbmddOiBjYWxsYmFja1tdIH0gPSB7fTtcclxuICBwcml2YXRlIHN0YXRpYyBpc0NvbnRlbnRQYWdlOiBib29sZWFuID0gUHViU3ViLmluaXQoKTtcclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHt9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGluaXQoKTogYm9vbGVhbiB7XHJcbiAgICBjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2U6IFB1YlN1Yk1lc3NhZ2UpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIG1lc3NhZ2UuZXh0ZW5zaW9uTmFtZSAhPT0gYXBwQ29uZmlnLmdlbmVyYWwuZXh0ZW5zaW9uTmFtZSB8fFxyXG4gICAgICAgIG1lc3NhZ2UuZXh0ZW5zaW9uSWQgIT09IGFwcENvbmZpZy5nZW5lcmFsLmV4dGVuc2lvbklkIHx8XHJcbiAgICAgICAgbWVzc2FnZS5tZXNzYWdlVHlwZSAhPT0gYXBwQ29uZmlnLmxpYnJhcmllcy5QdWJTdWIucG9ydE1lc3NhZ2VUeXBlXHJcbiAgICAgICkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgUHViU3ViLmVtaXRMb2NhbChtZXNzYWdlLmV2ZW50TmFtZSwgbWVzc2FnZS5kYXRhKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBQdWJTdWIuZ2V0SXNDb250ZW50UGFnZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0SXNDb250ZW50UGFnZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBsb2NhdGlvbi5wcm90b2NvbCAhPT0gYXBwQ29uZmlnLmdlbmVyYWwuY2hyb21lRXh0ZW5zaW9uUHJvdG9jb2w7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHN1YnNjcmliZShldmVudE5hbWU6IHN0cmluZywgY2FsbGJhY2s6IGNhbGxiYWNrKTogdm9pZCB7XHJcbiAgICBQdWJTdWIuY2FsbGJhY2tzQnlFdmVudHNbZXZlbnROYW1lXSA9XHJcbiAgICAgIFB1YlN1Yi5jYWxsYmFja3NCeUV2ZW50c1tldmVudE5hbWVdIHx8IFtdO1xyXG4gICAgUHViU3ViLmNhbGxiYWNrc0J5RXZlbnRzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHVuc3Vic2NyaWJlKGV2ZW50TmFtZTogc3RyaW5nLCBjYWxsYmFjazogY2FsbGJhY2spOiB2b2lkIHtcclxuICAgIGNvbnN0IGV2ZW50Q2FsbGJhY2tzID0gUHViU3ViLmNhbGxiYWNrc0J5RXZlbnRzW2V2ZW50TmFtZV07XHJcblxyXG4gICAgaWYgKCFldmVudENhbGxiYWNrcykgcmV0dXJuO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRDYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGV2ZW50Q2FsbGJhY2tzW2ldID09PSBjYWxsYmFjaykge1xyXG4gICAgICAgIGV2ZW50Q2FsbGJhY2tzLnNwbGljZShpLCAxKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBlbWl0KGV2ZW50TmFtZTogc3RyaW5nLCBkYXRhOiBhbnkgPSB7fSk6IHZvaWQge1xyXG4gICAgUHViU3ViLmVtaXRHbG9iYWwoZXZlbnROYW1lLCBkYXRhKTtcclxuICAgIFB1YlN1Yi5lbWl0TG9jYWwoZXZlbnROYW1lLCBkYXRhKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGVtaXRMb2NhbChldmVudE5hbWU6IHN0cmluZywgZGF0YTogYW55KSB7XHJcbiAgICBjb25zdCBldmVudENhbGxiYWNrcyA9IFB1YlN1Yi5jYWxsYmFja3NCeUV2ZW50c1tldmVudE5hbWVdO1xyXG5cclxuICAgIGlmICghZXZlbnRDYWxsYmFja3MpIHJldHVybjtcclxuXHJcbiAgICBldmVudENhbGxiYWNrcy5mb3JFYWNoKChjYWxsYmFjazogY2FsbGJhY2spID0+IHtcclxuICAgICAgY2FsbGJhY2soZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGVtaXRHbG9iYWwoZXZlbnROYW1lOiBzdHJpbmcsIGRhdGE6IGFueSk6IHZvaWQge1xyXG4gICAgaWYgKCFQdWJTdWIuaXNDb250ZW50UGFnZSkge1xyXG4gICAgICBQdWJTdWIuc2VuZE1lc3NhZ2VUb0NvbnRlbnQoZXZlbnROYW1lLCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBQdWJTdWIuc2VuZE1lc3NhZ2VUb0V4dGVuc2lvbihldmVudE5hbWUsIGRhdGEpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc2VuZE1lc3NhZ2VUb0V4dGVuc2lvbihldmVudE5hbWU6IHN0cmluZywgZGF0YTogYW55KTogdm9pZCB7XHJcbiAgICBjb25zdCBtZXNzYWdlID0gbmV3IFB1YlN1Yk1lc3NhZ2UoZXZlbnROYW1lLCBkYXRhKTtcclxuICAgIGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKG1lc3NhZ2UpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc2VuZE1lc3NhZ2VUb0NvbnRlbnQoZXZlbnROYW1lOiBzdHJpbmcsIGRhdGE6IGFueSk6IHZvaWQge1xyXG4gICAgY29uc3QgbWVzc2FnZSA9IG5ldyBQdWJTdWJNZXNzYWdlKGV2ZW50TmFtZSwgZGF0YSk7XHJcblxyXG4gICAgY2hyb21lLnRhYnMucXVlcnkoeyB1cmw6IGFwcENvbmZpZy5saWJyYXJpZXMuUHViU3ViLnVybFBhdHRlcm4gfSwgdGFicyA9PiB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFicy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGNocm9tZS50YWJzLnNlbmRNZXNzYWdlKHRhYnNbaV0uaWQsIG1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbnR5cGUgY2FsbGJhY2sgPSAoZGF0YTogYW55KSA9PiBhbnk7XHJcblxyXG5jbGFzcyBQdWJTdWJNZXNzYWdlIHtcclxuICBwdWJsaWMgZXh0ZW5zaW9uTmFtZTogc3RyaW5nO1xyXG4gIHB1YmxpYyBleHRlbnNpb25JZDogc3RyaW5nO1xyXG4gIHB1YmxpYyBtZXNzYWdlVHlwZTogc3RyaW5nO1xyXG4gIHB1YmxpYyBldmVudE5hbWU6IHN0cmluZztcclxuICBwdWJsaWMgZGF0YTogYW55O1xyXG5cclxuICBjb25zdHJ1Y3RvcihldmVudE5hbWU6IHN0cmluZywgZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLmV4dGVuc2lvbk5hbWUgPSBhcHBDb25maWcuZ2VuZXJhbC5leHRlbnNpb25OYW1lO1xyXG4gICAgdGhpcy5leHRlbnNpb25JZCA9IGFwcENvbmZpZy5nZW5lcmFsLmV4dGVuc2lvbklkO1xyXG4gICAgdGhpcy5tZXNzYWdlVHlwZSA9IGFwcENvbmZpZy5saWJyYXJpZXMuUHViU3ViLnBvcnRNZXNzYWdlVHlwZTtcclxuICAgIHRoaXMuZXZlbnROYW1lID0gZXZlbnROYW1lO1xyXG4gICAgdGhpcy5kYXRhID0gZGF0YTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSVN0b3JhYmxlIH0gZnJvbSAnLi9JU3RvcmFibGUnO1xyXG5pbXBvcnQgeyBVc2VyT3B0aW9ucyB9IGZyb20gJy4uL21vZGVscy9Vc2VyT3B0aW9ucyc7XHJcblxyXG5leHBvcnQgY2xhc3MgU3RvcmFnZVNlcnZpY2Uge1xyXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHVwZGF0ZUZyb21TdG9yYWdlPFQgZXh0ZW5kcyBJU3RvcmFibGU+KFxyXG4gICAgbW9kZWw6IFQsXHJcbiAgICBjYWxsYmFjazogY2FsbGJhY2s8VD5cclxuICApOiB2b2lkIHtcclxuICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChtb2RlbC5fX2tleV9fLCByZXN1bHQgPT4ge1xyXG4gICAgICBjb25zdCBzdG9yZWRNb2RlbDogVCA9IHJlc3VsdFttb2RlbC5fX2tleV9fXSBhcyBUO1xyXG4gICAgICBjb25zdCB1cGRhdGVkTW9kZWw6IFQgPSBPYmplY3QuYXNzaWduKHt9LCBtb2RlbCkgYXMgVDtcclxuXHJcbiAgICAgIGlmIChzdG9yZWRNb2RlbCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgZm9yIChsZXQgcHJvcGVydHkgaW4gdXBkYXRlZE1vZGVsKSB7XHJcbiAgICAgICAgICBpZiAoc3RvcmVkTW9kZWxbcHJvcGVydHldICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXBkYXRlZE1vZGVsW3Byb3BlcnR5XSA9IHN0b3JlZE1vZGVsW3Byb3BlcnR5XTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIFN0b3JhZ2VTZXJ2aWNlLnVwZGF0ZVRvU3RvcmFnZSh1cGRhdGVkTW9kZWwpO1xyXG5cclxuICAgICAgY2FsbGJhY2sodXBkYXRlZE1vZGVsKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyB1cGRhdGVUb1N0b3JhZ2U8VCBleHRlbmRzIElTdG9yYWJsZT4obW9kZWw6IFQpOiB2b2lkIHtcclxuICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldChtb2RlbCk7XHJcbiAgfVxyXG59XHJcblxyXG50eXBlIGNhbGxiYWNrPFQ+ID0gKHVwZGF0ZWRNb2RlbDogVCkgPT4gdm9pZDtcclxuIiwiaW1wb3J0IHsgYXBwQ29uZmlnIH0gZnJvbSAnLi4vY29uZmlnL2FwcC5jb25maWcnO1xyXG5pbXBvcnQgeyBJU3RvcmFibGUgfSBmcm9tICcuLi9zZXJ2aWNlcy9JU3RvcmFibGUnO1xyXG5cclxuY29uc3Qga2V5ID0gYXBwQ29uZmlnLm1vZGVscy5Vc2VyT3B0aW9ucy5zdG9yYWdlS2V5O1xyXG5jb25zdCBkZWZhdWx0cyA9IGFwcENvbmZpZy5tb2RlbHMuVXNlck9wdGlvbnMuZGVmYXVsdHM7XHJcblxyXG5leHBvcnQgY2xhc3MgVXNlck9wdGlvbnMgaW1wbGVtZW50cyBJU3RvcmFibGUge1xyXG4gIHB1YmxpYyBfX2tleV9fOiBzdHJpbmcgPSBrZXk7XHJcbiAgcHVibGljIGlzVXJsUmV3cml0ZXJPbjogYm9vbGVhbjtcclxuXHJcbiAgY29uc3RydWN0b3IoaXNVcmxSZXdyaXRlck9uOiBib29sZWFuID0gZGVmYXVsdHMuaXNVcmxSZXdyaXRlck9uKSB7XHJcbiAgICB0aGlzLmlzVXJsUmV3cml0ZXJPbiA9IGlzVXJsUmV3cml0ZXJPbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHViU3ViIH0gZnJvbSAnLi4vbGlicmFyaWVzL1B1YlN1Yic7XHJcbmltcG9ydCB7IEV2ZW50TmFtZXMgfSBmcm9tICcuLi9jb25maWcvRXZlbnROYW1lcyc7XHJcbmltcG9ydCB7IFVzZXJPcHRpb25zIH0gZnJvbSAnLi4vbW9kZWxzL1VzZXJPcHRpb25zJztcclxuaW1wb3J0IHsgU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9TdG9yYWdlU2VydmljZSc7XHJcbmltcG9ydCB7IEJhY2tncm91bmQgfSBmcm9tICcuLi9tb2RlbHMvQmFja2dyb3VuZCc7XHJcblxyXG5jb25zdCBzdGF0ZSA9IG5ldyBCYWNrZ3JvdW5kKCk7XHJcblxyXG5TdG9yYWdlU2VydmljZS51cGRhdGVGcm9tU3RvcmFnZTxVc2VyT3B0aW9ucz4oXHJcbiAgc3RhdGUudXNlck9wdGlvbnMsXHJcbiAgb25VcGRhdGVGcm9tU3RvcmFnZVxyXG4pO1xyXG5cclxuZnVuY3Rpb24gb25VcGRhdGVGcm9tU3RvcmFnZSh1c2VyT3B0aW9uczogVXNlck9wdGlvbnMpIHtcclxuICBzdGF0ZS51c2VyT3B0aW9ucyA9IHVzZXJPcHRpb25zO1xyXG4gIFB1YlN1Yi5lbWl0KEV2ZW50TmFtZXMub25Vc2VyT3B0aW9uc1VwZGF0ZSwgdXNlck9wdGlvbnMpO1xyXG5cclxuICBpbml0KCk7XHJcblxyXG4gIGNvbnNvbGUubG9nKCd1cGRhdGVkIGZyb20gc3RvcmFnZScpO1xyXG4gIGNvbnNvbGUubG9nKHN0YXRlLnVzZXJPcHRpb25zKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdCgpIHtcclxuICAvLyBUT0RPXHJcbn1cclxuXHJcblB1YlN1Yi5zdWJzY3JpYmUoRXZlbnROYW1lcy5vblVzZXJPcHRpb25zVXBkYXRlLCBvblVzZXJPcHRpb25zVXBkYXRlKTtcclxuUHViU3ViLnN1YnNjcmliZShFdmVudE5hbWVzLm9uSW5pdFJlcXVlc3QsIG9uSW5pdFJlcXVlc3QpO1xyXG5cclxuZnVuY3Rpb24gb25Vc2VyT3B0aW9uc1VwZGF0ZSh1c2VyT3B0aW9uczogVXNlck9wdGlvbnMpIHtcclxuICBzdGF0ZS51c2VyT3B0aW9ucyA9IHVzZXJPcHRpb25zO1xyXG4gIFN0b3JhZ2VTZXJ2aWNlLnVwZGF0ZVRvU3RvcmFnZSh1c2VyT3B0aW9ucyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9uSW5pdFJlcXVlc3QoKSB7XHJcbiAgUHViU3ViLmVtaXQoRXZlbnROYW1lcy5vbkluaXQsIHN0YXRlLnVzZXJPcHRpb25zKTtcclxuXHJcbiAgY29uc29sZS5sb2coJ2dvdCBhbiBpbml0IHJlcXVlc3QnKTtcclxufVxyXG4iLCJpbXBvcnQgeyBVc2VyT3B0aW9ucyB9IGZyb20gJy4vVXNlck9wdGlvbnMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJhY2tncm91bmQge1xyXG4gIHB1YmxpYyB1c2VyT3B0aW9uczogVXNlck9wdGlvbnM7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy51c2VyT3B0aW9ucyA9IG5ldyBVc2VyT3B0aW9ucygpO1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9